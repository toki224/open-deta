================================================================================
バリアナビ（身体障害向け）Webアプリケーション - プログラム概要
================================================================================

このドキュメントは、ITやプログラミング初心者の方向けに、このWebアプリケーションが
どのように動作しているかをわかりやすく説明したものです。

================================================================================
【このアプリケーションについて】
================================================================================

このアプリケーションは「バリアナビ（身体障害向け）」という名前で、
MySQLデータベースに保存されている駅のバリアフリー情報を、身体障害者の方に
見やすく表示するためのWebアプリケーションです。

■ 主な目的
  身体障害者が駅を利用する際に、その駅が自分にとって利用しやすいかどうかを
  事前に判断できるようにすることを目的としています。

■ 主な機能
  ・駅のバリアフリー度を15項目で評価し、スコア（例：8/15点）で表示
  ・駅名で検索する
  ・都道府県で絞り込む
  ・バリアフリー設備の有無で絞り込む
  ・各駅の詳細情報を確認できる（15項目の内訳と基準値）

■ 評価システム
  全15項目のバリアフリー設備を評価し、基準値を満たした項目数をスコアとして表示します。
  各項目は「達成（1点）」または「未達成（0点）」の2値で評価されます。

================================================================================
【全体の構成（3つのパート）】
================================================================================

このアプリケーションは、大きく分けて3つのパートで構成されています：

┌─────────────────────────────────────────────────────────────┐
│  1. データベース（MySQL）                                    │
│     → 駅のバリアフリー設備データが保存されている場所        │
│     → stationデータベースのstationsテーブル                 │
└─────────────────────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────────────────┐
│  2. バックエンド（Python + Flask）                           │
│     → データベースからデータを取得し、スコアを計算して       │
│       ブラウザに渡す役割                                     │
│     → APIサーバーとして動作（http://localhost:5000）        │
└─────────────────────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────────────────┐
│  3. フロントエンド（HTML + CSS + TypeScript/JavaScript）    │
│     → ブラウザで表示される画面と、ユーザーが操作する部分   │
│     → 一覧画面（index.html）と詳細画面（detail.html）       │
└─────────────────────────────────────────────────────────────┘

================================================================================
【評価項目（全15項目）】
================================================================================

このアプリケーションでは、身体障害者にとって重要な15項目のバリアフリー設備を
評価しています。

■ フラグ型項目（5項目）：〇×で表せる項目
───────────────────────────────────────────────────────────────

1. 段差への対応
2. 案内設備の設置の有無
3. 障害者対応型便所の設置の有無
4. 障害者対応型改札口の設置の有無
5. 転落防止のための設備の設置の有無

→ 評価基準：設備が設置されていれば（値が「1」）1点、それ以外は0点

■ 数値型項目（10項目）：数値で表せる項目
───────────────────────────────────────────────────────────────

6. プラットホームの数（基準値：6以上）
7. 段差が解消されているプラットホームの数（基準値：6以上）
8. エレベーターの設置基数（基準値：4基以上）
9. 移動等円滑化基準に適合しているエレベーターの設置基数（基準値：4基以上）
10. エスカレーターの設置基数（基準値：4基以上）
11. 移動等円滑化基準に適合しているエスカレーターの設置基数（基準値：4基以上）
12. その他の昇降機の設置基数（基準値：2基以上）
13. 傾斜路の設置箇所数（基準値：2箇所以上）
14. 移動等円滑化基準に適合している傾斜路の設置箇所数（基準値：2箇所以上）
15. 車いす使用者の円滑な乗降が可能なプラットホームの数（基準値：6以上）

→ 評価基準：基準値以上であれば1点、未満なら0点

詳細な評価基準については、「スコア計算ロジック説明.txt」を参照してください。

================================================================================
【各ファイルの役割】
================================================================================

■ データベース関連
───────────────────────────────────────────────────────────────

・database_connection.py
  役割：MySQLデータベースに接続するためのプログラム
  説明：データベースとやり取りするための「道具箱」のようなものです。
       データを取得したり、保存したりする機能が入っています。
       環境変数（.envファイル）から接続情報を読み込みます。

■ バックエンド（サーバー側）
───────────────────────────────────────────────────────────────

・api_server.py
  役割：Webサーバーとして動作し、データベースからデータを取得して
       スコアを計算し、ブラウザに渡すプログラム
  説明：
  - FlaskというPythonのWebフレームワークを使用
  - ブラウザからの「このデータをください」というリクエストを受け取り、
    データベースからデータを取得
  - 15項目のバリアフリー設備を評価し、スコアを計算
  - 計算結果をブラウザに返す
  - 例えるなら、レストランの「注文を受けて、キッチンから料理を
    持ってくるウェイター」のような存在です

  主な機能：
  - 駅一覧の取得とスコア計算（/api/body/stations）
  - 駅詳細情報の取得とスコア計算（/api/body/stations/<id>）
  - 都道府県一覧の取得（/api/stations/prefectures）
  - 検索・フィルタ・ページネーション機能

■ フロントエンド（ブラウザ側）
───────────────────────────────────────────────────────────────

・home.html / src/home.ts / dist/home.js
  役割：ホーム画面（障害カテゴリ選択画面）
  説明：身体障害・聴覚障害・視覚障害のカテゴリを選択する画面です。
       現在は身体障害のみ実装されています。

・index.html / src/index.ts / dist/index.js
  役割：一覧画面（身体障害向け駅一覧）
  説明：
  - 駅の一覧を表示し、各駅のスコア（例：8/15点）を表示
  - 検索・フィルタ・ページネーション機能
  - 駅カードをクリックすると詳細画面に遷移

・detail.html / src/detail.ts / dist/detail.js
  役割：詳細画面（駅のバリアフリー設備詳細）
  説明：
  - 選択した駅の15項目のバリアフリー設備の詳細を表示
  - 各項目の「設置の有無と数」と「基準値」を並べて表示
  - 実際の値と基準値を比較できる

・styles.css
  役割：画面の見た目を整えるファイル
  説明：色、大きさ、レイアウトなどを決めています。
       例えるなら、家の「内装デザイン」のようなものです。

■ 設定ファイル
───────────────────────────────────────────────────────────────

・package.json
  役割：Node.js（JavaScriptを実行する環境）で使用する設定ファイル
  説明：TypeScriptをコンパイルする際に必要なツールのリストが書かれています。

・tsconfig.json
  役割：TypeScriptの設定ファイル
  説明：TypeScriptをJavaScriptに変換する際のルールを決めています。

・requirements.txt
  役割：Pythonで使用するライブラリのリスト
  説明：このアプリで必要なPythonのパッケージ（追加機能）が
       リストアップされています。
       主なパッケージ：
       - Flask: Webサーバーフレームワーク
       - mysql-connector-python: MySQL接続用
       - flask-cors: CORS対応用
       - python-dotenv: 環境変数管理用

・.env（.env.exampleを参考に作成）
  役割：環境変数ファイル（MySQL接続情報など）
  説明：機密情報を含むため、Gitにはコミットしません。
       以下の情報を設定します：
       - MYSQL_HOST: MySQLサーバーのホスト名
       - MYSQL_PORT: MySQLサーバーのポート番号
       - MYSQL_USER: MySQLユーザー名
       - MYSQL_PASSWORD: MySQLパスワード
       - MYSQL_DATABASE: データベース名（station）

・README.md
  役割：このアプリの使い方を説明したドキュメント
  説明：セットアップ方法や実行方法が書かれています。

・スコア計算ロジック説明.txt
  役割：スコア計算の詳細な説明
  説明：15項目の評価基準や計算方法が詳しく書かれています。

================================================================================
【データの流れ（実際の動作）】
================================================================================

■ 一覧画面を表示する場合
───────────────────────────────────────────────────────────────

1. ユーザーがブラウザでindex.htmlを開く
   ↓
2. ブラウザがdist/index.jsを読み込んで実行する
   ↓
3. index.jsが「api_server.py」に「駅一覧データをください」とリクエストを送る
   ↓
4. api_server.pyが「database_connection.py」を使ってデータベースから駅データを取得
   ↓
5. api_server.pyが各駅について15項目を評価し、スコアを計算
   ↓
6. api_server.pyが計算結果（スコア付き駅一覧）をブラウザに返す
   ↓
7. index.jsが受け取ったデータを画面に表示する（駅カードとして表示）

■ 詳細画面を表示する場合
───────────────────────────────────────────────────────────────

1. ユーザーが一覧画面で駅カードをクリックする
   ↓
2. detail.htmlに遷移し、dist/detail.jsが実行される
   ↓
3. detail.jsが「api_server.py」に「この駅の詳細データをください」とリクエストを送る
   ↓
4. api_server.pyがデータベースから該当駅のデータを取得
   ↓
5. api_server.pyが15項目の詳細を評価し、各項目の達成状況を計算
   ↓
6. api_server.pyが詳細情報（各項目の値と基準値）をブラウザに返す
   ↓
7. detail.jsが受け取ったデータをテーブル形式で表示する

■ 検索・フィルタ機能を使う場合
───────────────────────────────────────────────────────────────

1. ユーザーが検索ボックスに駅名を入力、またはフィルタを選択
   ↓
2. index.jsが検索条件を「api_server.py」に送る
   ↓
3. api_server.pyがデータベースから条件に合う駅を検索
   ↓
4. api_server.pyが検索結果のスコアを計算
   ↓
5. api_server.pyが検索結果をブラウザに返す
   ↓
6. index.jsが検索結果を画面に表示する

================================================================================
【スコア計算の仕組み】
================================================================================

このアプリケーションの特徴は、各駅のバリアフリー度を数値（スコア）で
評価することです。

■ スコアの計算方法
───────────────────────────────────────────────────────────────

1. 各項目の評価
   - フラグ型項目：値が「1」なら達成（1点）、それ以外は未達成（0点）
   - 数値型項目：実際の値が基準値以上なら達成（1点）、未満なら未達成（0点）

2. 達成項目数のカウント
   - 全15項目のうち、達成した項目の数をカウント

3. スコアの表示
   - 「達成項目数 / 総項目数 点」の形式で表示（例：8/15点）
   - 達成率（パーセンテージ）も計算されます

■ 基準値について
───────────────────────────────────────────────────────────────

各数値型項目には基準値が設定されています：
- プラットホーム関連：6以上
- エレベーター・エスカレーター関連：4基以上
- その他の昇降機・傾斜路：2以上

これらの基準値は、身体障害者が実際に駅を利用する上で必要な
設備の充実度を考慮して設定されています。

詳細は「スコア計算ロジック説明.txt」を参照してください。

================================================================================
【専門用語の簡単な説明】
================================================================================

・データベース（Database）
  データを整理して保存しておく場所。Excelの表のようなもの。
  このアプリでは、駅のバリアフリー設備情報が保存されています。

・MySQL
  データベースの種類の一つ。無料で使える人気のデータベース。

・バックエンド（Backend）
  ユーザーには見えない部分。サーバー側で動くプログラム。
  このアプリでは、データベースからデータを取得し、スコアを計算する部分。

・フロントエンド（Frontend）
  ユーザーが見る部分。ブラウザで表示される画面。
  このアプリでは、駅一覧や詳細情報を表示する画面。

・API（Application Programming Interface）
  プログラム同士がやり取りするための「窓口」のようなもの。
  このアプリでは、フロントエンドとバックエンドがやり取りする
  ための仕組みです。

・HTTPリクエスト
  ブラウザがサーバーに「データをください」と送るメッセージ。

・HTTPレスポンス
  サーバーがブラウザに「はい、データです」と返すメッセージ。

・CORS（Cross-Origin Resource Sharing）
  異なるドメイン（場所）からデータを取得することを許可する仕組み。
  このアプリでは、ブラウザ（localhost:8000）からAPIサーバー
  （localhost:5000）にアクセスするために必要です。

・TypeScript
  JavaScriptに「型」という概念を追加した言語。
  より安全で、間違いを見つけやすいプログラムを書けます。

・コンパイル
  人間が書いたプログラムを、コンピューターが理解できる形式に
  変換すること。TypeScriptをJavaScriptに変換することも
  コンパイルと呼びます。

・スコアリング
  複数の評価項目をもとに、総合的な評価を数値で表すこと。
  このアプリでは、15項目のバリアフリー設備をもとに、
  0点〜15点のスコアで評価します。

・基準値
  評価の基準となる値。このアプリでは、各数値型項目に基準値が
  設定されており、その値以上であれば達成とみなします。

================================================================================
【このアプリを動かすために必要なもの】
================================================================================

1. Python（プログラムを実行する環境）
   → バックエンドを動かすために必要
   → Python 3.x が必要

2. MySQL（データベース）
   → 駅のデータを保存するために必要
   → MySQLサーバーが起動している必要があります

3. ブラウザ（Chrome、Firefox、Edgeなど）
   → フロントエンドを表示するために必要

4. （オプション）Node.js
   → TypeScriptをJavaScriptに変換するために必要
   → ただし、既にdist/フォルダにコンパイル済みのファイルがあるので、
     今はなくても動きます
   → TypeScriptファイルを編集して再ビルドしたい場合のみ必要

================================================================================
【ファイルの関係図】
================================================================================

┌─────────────────────────────────────────────────────────────┐
│  フロントエンド（ブラウザ側）                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │ home.html    │  │ index.html   │  │ detail.html  │     │
│  │ styles.css   │  │ styles.css   │  │ styles.css   │     │
│  │ dist/home.js │  │ dist/index.js│  │ dist/detail.js│    │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
└────────────┬───────────────────────────────┬───────────────┘
             │                               │
             │ HTTPリクエスト                │
             │                               │
             ↓                               ↓
┌─────────────────────────────────────────────────────────────┐
│  バックエンド（サーバー側）                                │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  api_server.py                                       │  │
│  │  - 駅一覧取得API（/api/body/stations）              │  │
│  │  - 駅詳細取得API（/api/body/stations/<id>）         │  │
│  │  - スコア計算ロジック                                │  │
│  └────────────┬─────────────────────────────────────────┘  │
│               │                                             │
│               ↓                                             │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  database_connection.py                              │  │
│  │  - MySQLデータベース接続管理                         │  │
│  └────────────┬─────────────────────────────────────────┘  │
└───────────────┼─────────────────────────────────────────────┘
                │ SQLクエリ
                ↓
┌─────────────────────────────────────────────────────────────┐
│  データベース（MySQL）                                      │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  stationデータベース                                  │  │
│  │  └─ stationsテーブル                                 │  │
│  │     - 駅の基本情報（駅名、都道府県など）            │  │
│  │     - バリアフリー設備情報（15項目）                 │  │
│  └──────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘

================================================================================
【初心者の方が理解すべきポイント】
================================================================================

1. このアプリは「クライアント・サーバー型」のアプリケーションです
   → ブラウザ（クライアント）がサーバーにデータを要求し、
     サーバーがデータベースから取得して、スコアを計算して返すという仕組みです

2. データベースは「データの倉庫」のようなものです
   → 駅のバリアフリー設備情報が整理されて保存されています

3. バックエンドとフロントエンドは「役割分担」しています
   → バックエンド：データの取得・スコア計算・処理
   → フロントエンド：データの表示・ユーザー操作の受け付け

4. スコア計算はバックエンドで行われます
   → 15項目のバリアフリー設備を評価し、基準値と比較してスコアを計算
   → フロントエンドは計算結果を受け取って表示するだけ

5. TypeScriptは「より安全なJavaScript」です
   → 最終的にはJavaScriptに変換されてブラウザで実行されます
   → src/フォルダのTypeScriptファイルが、dist/フォルダのJavaScriptファイルに
     コンパイルされます

6. APIは「プログラム同士の会話の窓口」です
   → フロントエンドとバックエンドが情報をやり取りするための
     決まった方法です
   → このアプリでは、JSON形式でデータをやり取りします

================================================================================
【画面の構成】
================================================================================

■ ホーム画面（home.html）
───────────────────────────────────────────────────────────────
障害カテゴリを選択する画面です。
- 身体障害（実装済み）
- 聴覚障害（準備中）
- 視覚障害（準備中）

■ 一覧画面（index.html）
───────────────────────────────────────────────────────────────
身体障害向けの駅一覧を表示する画面です。
- 検索バー：駅名で検索
- フィルタパネル：
  - 都道府県で絞り込み
  - バリアフリー設備で絞り込み（15項目のチェックボックス）
- 駅カード一覧：各駅のスコア（例：8/15点）を表示
- ページネーション：大量の駅データをページごとに表示

■ 詳細画面（detail.html）
───────────────────────────────────────────────────────────────
選択した駅のバリアフリー設備の詳細を表示する画面です。
- 駅の基本情報（駅名、鉄道事業者、路線、所在地）
- スコア表示（例：8/15点）
- 詳細テーブル：
  - 項目名
  - 設置の有無と数（実際の値）
  - 基準値（比較用）

================================================================================
【学習のヒント】
================================================================================

もし、このアプリを理解して、自分でも作れるようになりたい場合は、
以下の順番で学習することをおすすめします：

1. HTMLとCSSの基礎
   → 画面の見た目を作る方法を学ぶ
   → このアプリでは、index.html、detail.html、styles.cssが該当

2. JavaScriptの基礎
   → 画面を動かす方法を学ぶ
   → このアプリでは、dist/index.js、dist/detail.jsが該当
   → TypeScriptを学ぶと、より安全なコードが書けます

3. Pythonの基礎
   → サーバー側のプログラムの書き方を学ぶ
   → このアプリでは、api_server.py、database_connection.pyが該当

4. データベース（SQL）の基礎
   → データの保存・取得方法を学ぶ
   → このアプリでは、MySQLを使用しています

5. Webアプリケーションの仕組み
   → クライアント・サーバー型アプリの動作原理を学ぶ
   → HTTPリクエスト・レスポンスの仕組みを理解する

6. APIの設計
   → フロントエンドとバックエンドがどのようにデータをやり取りするか
   → このアプリでは、RESTful APIの設計思想を採用しています

================================================================================
【まとめ】
================================================================================

このWebアプリケーション「バリアナビ（身体障害向け）」は、以下の3つのパートで
構成されています：

1. データベース（MySQL）
   → 駅のバリアフリー設備データが保存されている場所

2. バックエンド（Python + Flask）
   → データベースからデータを取得し、15項目のバリアフリー設備を評価して
     スコアを計算し、ブラウザに渡す役割

3. フロントエンド（HTML + CSS + TypeScript/JavaScript）
   → ブラウザで表示される画面と、ユーザーが操作する部分
   → 一覧画面と詳細画面の2つの画面があります

各ファイルはそれぞれ異なる役割を持っており、協力して動作することで、
身体障害者の方がブラウザで駅のバリアフリー情報を検索・表示・比較できる
ようになっています。

このアプリケーションの特徴は、単にデータを表示するだけでなく、
15項目のバリアフリー設備を評価し、スコアとして見える化している点です。
これにより、ユーザーは複数の駅を比較して、自分にとって利用しやすい駅を
見つけることができます。

================================================================================
【関連ドキュメント】
================================================================================

- README.md：セットアップ方法や実行方法
- スコア計算ロジック説明.txt：スコア計算の詳細な仕組み
- docs/barianavi_spec.md：バリアナビの詳細仕様書

================================================================================
作成日：2025年
対象：IT・プログラミング初心者の方
================================================================================
